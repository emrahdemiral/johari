<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Johari Analiz</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f4f4f4;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    h2, h3 {
      text-align: center;
    }
    input, button {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }
    .section {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
    }
    ul {
      columns: 2;
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <h2>Johari Penceresi Analizi</h2>
  <p>Kendi adınızı girerek Johari alanlarınızı keşfedin:</p>
  <input type="text" id="nameInput" placeholder="Adınızı yazın">
  <button onclick="analyzeJohari()">Analizi Göster</button>
  <div id="results"></div>

  <script>
    const traits = [
      "Güvenilir","Destekleyici","Planlı","Adil","Sonuç odaklı","Sistemli","Mutlu",
      "İnisiyatif alan","Analitik","Sakin","Vizyoner","Proaktif","İlham verici","Mantıklı",
      "Empatik","Pratik","İyimser","Cesur","Çatışma çözen","Yardım eden","İdealist",
      "Kararlı","Organize","Saygılı","Yapıcı","Yol gösterici","Çok yönlü","Sevecen",
      "Takım oyuncusu","Disiplinli","Çözüm odaklı","Gelişime açık","İşbirliğine açık","Öğrenmeye açık","Maharetli",
      "Yenilikçi","Net mesaj veren","Dinlemeyi bilen","İfade gücü yüksek","Kendini tanıyan","Eleştirel bakan","Düşünceli",
      "Sorumluluk sahibi","Motive edici","Yardımsever","İlişki kurabilen","Meraklı","Tutkulu","İlgili",
      "İkna edici","Uyumlu","Hızlı öğrenen","Kapsayıcı","Nazik","Özenli","Enerjik",
      "Sabırlı","Esnek","Özgüvenli","Müşteri odaklı","Dengeli","Adaptif","Dışa dönük",
      "Sabırsız","İnatçı","İçe dönük","Kötümser","Eleştiriye kapalı","Kontrolcü","Asabi",
      "Kararsız","Kırılgan","Detaycı","Sert üsluplu","Çabuk demotive olan","Kibirli","Kontrol delisi",
      "Aceleci","Soğuk","Gergin","Pasif","Dinlemeyen","Aşırı eleştirel","Katı"
    ];

    async function analyzeJohari() {
      const name = document.getElementById("nameInput").value.trim();
      if (!name) return alert("Lütfen adınızı girin.");

      const res = await fetch("https://sheetdb.io/api/v1/ygs2xvq4fqvi3");
      const data = await res.json();

      const selfTraits = data.filter(row => row.name.toLowerCase() === name.toLowerCase() && row.mode === "self")
                             .flatMap(r => r.selected.split(", "));

      const otherTraitsRaw = data.filter(row => row.name.toLowerCase() === name.toLowerCase() && row.mode === "other");

      const otherCount = {};
      otherTraitsRaw.forEach(row => {
        row.selected.split(", ").forEach(trait => {
          otherCount[trait] = (otherCount[trait] || 0) + 1;
        });
      });

      const totalOther = otherTraitsRaw.length;

      const openArea = [];
      const blindArea = [];
      const hiddenArea = [];
      const unknownArea = [];

      traits.forEach(trait => {
        const inSelf = selfTraits.includes(trait);
        const inOther = otherCount[trait];

        if (inSelf && inOther) {
          openArea.push(`${trait} (%${Math.round((inOther / totalOther) * 100)})`);
        } else if (!inSelf && inOther) {
          blindArea.push(`${trait} (%${Math.round((inOther / totalOther) * 100)})`);
        } else if (inSelf && !inOther) {
          hiddenArea.push(trait);
        } else {
          unknownArea.push(trait);
        }
      });

      document.getElementById("results").innerHTML = `
        <div class="section"><h3>🔓 Açık Alan</h3><ul>${openArea.map(t => `<li>${t}</li>`).join('')}</ul></div>
        <div class="section"><h3>👁️ Kör Alan</h3><ul>${blindArea.map(t => `<li>${t}</li>`).join('')}</ul></div>
        <div class="section"><h3>🔒 Gizli Alan</h3><ul>${hiddenArea.map(t => `<li>${t}</li>`).join('')}</ul></div>
        <div class="section"><h3>❔ Bilinmeyen Alan</h3><ul>${unknownArea.map(t => `<li>${t}</li>`).join('')}</ul></div>
      `;
    }
  </script>
</body>
</html>
