<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Johari Analiz</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }
    h2 {
      text-align: center;
    }
    #nameSelect {
      display: block;
      margin: 0 auto 20px auto;
      padding: 8px;
      width: 220px;
    }
    .grid-2x2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .box {
      border: 1px solid #aaa;
      padding: 15px;
      background-color: #fff;
      border-radius: 8px;
    }
    .box h3 {
      margin-top: 0;
      text-align: center;
    }
    ul {
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <h2>Johari Penceresi Analizi</h2>
  <p style="text-align: center;">Johari penceresini görmek istediğiniz ismi seçin</p>
  <select id="nameSelect">
    <option value="">İsim seçin</option>
  </select>

  <div id="analysis" class="grid-2x2" style="margin-top: 20px;"></div>

  <script>
    const nameSelect = document.getElementById("nameSelect");
    const analysisDiv = document.getElementById("analysis");

    fetch("https://sheetdb.io/api/v1/ygs2xvq4fqvi3/sheet?sheet=isimler")
      .then(res => res.json())
      .then(data => {
        const names = [...new Set(data.map(entry => entry.name).filter(n => n))];
        nameSelect.innerHTML = '<option value="">İsim seçin</option>' + names.map(name => `<option value="${name}">${name}</option>`).join('');
      });

    nameSelect.addEventListener("change", () => {
      const selectedName = nameSelect.value.trim().toLowerCase();
      if (!selectedName) return;

      fetch("https://sheetdb.io/api/v1/ygs2xvq4fqvi3")
        .then(res => res.json())
        .then(data => {
          const selfEntry = data.find(row => row.name?.toLowerCase() === selectedName && row.mode === "self");
          const otherEntries = data.filter(row => row.name?.toLowerCase() === selectedName && row.mode === "other");

          const selfTraits = selfEntry?.selected?.split(",").map(s => s.trim()) || [];
          const otherTraits = otherEntries.flatMap(row => row.selected.split(",").map(s => s.trim()));
          const uniqueOtherTraits = [...new Set(otherTraits)];

          const openArea = selfTraits.filter(trait => uniqueOtherTraits.includes(trait));
          const blindSpot = uniqueOtherTraits.filter(trait => !selfTraits.includes(trait));
          const hiddenArea = selfTraits.filter(trait => !uniqueOtherTraits.includes(trait));
          const allTraits = [
            ...new Set([...selfTraits, ...uniqueOtherTraits])
          ];
          const fullList = [
            "Güvenilir", "Destekleyici", "Planlı", "Adil", "Sonuç odaklı", "Sistemli", "Mutlu",
            "İnisiyatif alan", "Analitik", "Sakin", "Vizyoner", "Proaktif", "İlham verici", "Mantıklı",
            "Empatik", "Pratik", "İyimser", "Cesur", "Çatışma çözen", "Yardım eden", "İdealist",
            "Kararlı", "Organize", "Saygılı", "Yapıcı", "Yol gösterici", "Çok yönlü", "Sevecen",
            "Takım oyuncusu", "Disiplinli", "Çözüm odaklı", "Gelişime açık", "İşbirliğine açık", "Öğrenmeye açık", "Maharetli",
            "Yenilikçi", "Net mesaj veren", "Dinlemeyi bilen", "İfade gücü yüksek", "Kendini tanıyan", "Eleştirel bakan", "Düşünceli",
            "Sorumluluk sahibi", "Motive edici", "Yardımsever", "İlişki kurabilen", "Meraklı", "Tutkulu", "İlgili",
            "İkna edici", "Uyumlu", "Hızlı öğrenen", "Kapsayıcı", "Nazik", "Özenli", "Enerjik",
            "Sabırlı", "Esnek", "Özgüvenli", "Müşteri odaklı", "Dengeli", "Adaptif", "Dışa dönük",
            "Sabırsız", "İnatçı", "İçe dönük", "Kötümser", "Eleştiriye kapalı", "Kontrolcü", "Asabi",
            "Kararsız", "Kırılgan", "Detaycı", "Sert üsluplu", "Çabuk demotive olan", "Kibirli", "Kontrol delisi",
            "Aceleci", "Soğuk", "Gergin", "Pasif", "Dinlemeyen", "Aşırı eleştirel", "Katı"
          ];
          const unknown = fullList.filter(trait => !allTraits.includes(trait));

          const boxTemplate = (title, items) => `
            <div class="box">
              <h3>${title}</h3>
              <ul>${items.map(trait => `<li>${trait}</li>`).join('')}</ul>
            </div>`;

          analysisDiv.innerHTML =
            boxTemplate("Açık Alan", openArea) +
            boxTemplate("Kör Alan", blindSpot) +
            boxTemplate("Gizli Alan", hiddenArea) +
            boxTemplate("Bilinmeyen Alan", unknown);
        });
    });
  </script>
</body>
</html>
